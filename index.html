<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MRZYB Player Seri Universal</title>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
<style>
body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  color: #f5f5f5;
  background: linear-gradient(135deg, #0f0f0f, #1c1c1c);
}

/* Header Section */
.bg-fondo {
  display: flex;
  align-items: flex-end;
  padding: 20px;
  padding-top: 160px;
  position: relative;
  background: none;
}
.bg-fondo::before {
  content: '';
  position: absolute;
  top:0;left:0;width:100%;height:100%;
  background: url('https://i.ibb.co/mTQnv8L/bg.jpg') no-repeat center/cover;
  z-index:-1;
  filter: blur(8px) brightness(0.6);
}

/* Poster & Branding */
.poster-wrapper {
  position: relative;
  display: inline-block;
  width: 100%;
}
#poster {
  width: 100%;
  max-width: 250px;
  border-radius: 15px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.7);
}
.poster-brand {
  position: absolute;
  top: 10px;
  left: 10px;
  font-weight: bold;
  color: #ff5252;
  background: rgba(0,0,0,0.6);
  padding: 5px 10px;
  border-radius: 6px;
  font-size: 14px;
}

/* Title & Meta */
#title {
  font-size: 1.8rem;
  font-weight: 600;
  margin-bottom: 5px;
}
.movie-meta .chip {
  background: #222;
  color: #ffeb3b;
  font-weight: bold;
}

/* Episode buttons */
.episode-scroll-wrapper {
  overflow-x: auto;
  padding: 15px 0;
}
.episode-scroll {
  display: flex;
  gap: 12px;
}
.episode-btn {
  flex-shrink: 0;
  min-width: 70px;
  text-align: center;
  background: #333 !important;
  border-radius: 12px;
  transition: all 0.3s ease;
}
.episode-btn:hover {
  background: #ff5252 !important;
  transform: scale(1.05);
}
.active-episode {
  background: #ff1744 !important;
}

/* Modal player */
.modal-content {
  background: #111;
  border-radius: 16px;
  padding: 0;
  overflow: hidden;
  box-shadow: 0 6px 25px rgba(0,0,0,0.8);
}
.modal-close {
  position: absolute;
  top: 10px;
  right: 15px;
  font-size: 22px;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}
.modal-close:hover {
  color: #ff5252;
}

/* Input Section */
.input-section {
  margin-top: 40px;
  background: #1e1e1e;
  padding: 20px;
  border-radius: 14px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.6);
}
.input-section input, .input-section textarea {
  background: #2a2a2a;
  border: none;
  color: #fff;
  padding: 10px;
  border-radius: 8px;
  margin-bottom: 12px;
}
.input-section button {
  width: 100%;
  background: linear-gradient(45deg, #ff1744, #ff9100);
  border: none;
  padding: 12px;
  border-radius: 12px;
  color: #fff;
  font-size: 1rem;
  font-weight: bold;
  transition: 0.3s;
}
.input-section button:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 20px rgba(255,87,34,0.6);
}

.iframe-container{position:relative;width:100%;padding-top:56.25%;}
.responsive-iframe{position:absolute;top:0;left:0;width:100%;height:100%;}
</style>
</head>
<body class="grey darken-4">

<!-- HEADER: Poster + Judul -->
<div class="row bg-fondo" id="bgFondo">
  <div class="col s4 m3 l2">
    <div class="poster-wrapper">
      <img id="poster" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQAlGKrUpV0HWQsFq_WSbm9CU6OG3Pvz-92su1VM5dgq4587jCmQ9sD-mk&s=10" class="responsive-img" />
      <span class="mrzyb poster-brand">MRZYB</span>
    </div>
  </div>
  <div class="col s8 m9 l10">
    <h5 class="white-text mrzyb" id="title" style="margin-top:10px;">CHALKZONE</h5>
    <div class="movie-meta">
      <div class="chip" id="genre">School</div>
      <div class="chip" id="rating">⭐ 10</div>
    </div>
    <h6>DAFTAR EPISODE</h6>
    <div class="episode-scroll-wrapper">
      <div class="episode-scroll" id="episode-list">
        <!-- Tombol episode akan di-generate JS -->
      </div>
    </div>
  </div>
</div>

<!-- PLAYER MODAL -->
<div id="modal2" class="modal grey darken-4">
  <div class="modal-content white-text">
    <span class="modal-close" onclick="closeModal()">✖</span>
    <div class="iframe-container">
      <iframe allowfullscreen class="responsive-iframe" id="video-player" sandbox="allow-same-origin allow-scripts" scrolling="no"></iframe>
    </div>
  </div>
</div>

<!-- INPUT GENERATE -->
<div class="container input-section">
  <h6>Isi Data Film / Seri</h6>
  <input type="text" id="titleInput" placeholder="Judul Film">
  <input type="text" id="posterInput" placeholder="URL Poster">
  <input type="text" id="genreInput" placeholder="Genre">
  <input type="text" id="ratingInput" placeholder="Rating">
  <textarea id="episodesInput" placeholder="Masukkan link episode, satu per baris"></textarea>
  <button onclick="generateSeries()">Generate Link & Load</button>
  <div id="shareResult" style="margin-top:10px;"></div>
</div>

<!-- SCRIPT -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script>
M.AutoInit();

function openModal(){document.getElementById('modal2').style.display='flex';}
function closeModal(){document.getElementById('video-player').src='';document.getElementById('modal2').style.display='none';}

function loadSeries(data){
  if(data.poster) document.getElementById("poster").src=data.poster;
  if(data.title) document.getElementById("title").innerText=data.title;
  if(data.genre) document.getElementById("genre").innerText=data.genre;
  if(data.rating) document.getElementById("rating").innerText="⭐ "+data.rating;

  const epContainer=document.getElementById("episode-list");
  epContainer.innerHTML="";
  if(data.episodes && data.episodes.length>0){
    data.episodes.forEach((ep,index)=>{
      const btn=document.createElement("a");
      btn.className="waves-effect blue btn episode-btn";
      btn.innerText=ep.name||("Ep "+(index+1));
      btn.href="#!";
      btn.dataset.video=ep.video;
      btn.onclick=function(){
        document.querySelectorAll('.episode-btn').forEach(b=>b.classList.remove('active-episode'));
        btn.classList.add('active-episode');
        document.getElementById('video-player').src=ep.video;
        openModal();
      };
      epContainer.appendChild(btn);
    });
  }
}

function generateSeries(){
  const title=document.getElementById("titleInput").value.trim();
  const poster=document.getElementById("posterInput").value.trim();
  const genre=document.getElementById("genreInput").value.trim();
  const rating=document.getElementById("ratingInput").value.trim();
  const epText=document.getElementById("episodesInput").value.trim();
  if(!epText){alert("Masukkan setidaknya satu link episode!"); return;}
  const epLines=epText.split("\n").map((url,i)=>({name:"Ep "+(i+1),video:url}));
  const data={title,poster,genre,rating,episodes:epLines};
  loadSeries(data);
  const encoded=btoa(JSON.stringify(data));
  const link=window.location.origin+window.location.pathname+"?data="+encoded;
  document.getElementById("shareResult").innerHTML=`<input style="width:100%;padding:8px;color:#0f0;background:#111;border:none;border-radius:5px;" value="${link}" readonly onclick="this.select()">`;
}

// Load dari URL Base64 jika ada
window.addEventListener("DOMContentLoaded",()=>{
  const params=new URLSearchParams(window.location.search);
  const encoded=params.get("data");
  if(encoded){
    try{
      const decoded=atob(encoded);
      const obj=JSON.parse(decoded);
      loadSeries(obj);
    }catch(e){console.error("Link tidak valid!");}
  }
});
</script>

</body>
</html>
